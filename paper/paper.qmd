---
title: " Total Team Spending and Profitability Results in a Higher League Ranking in the English Premier League"
subtitle: "An Analysis of Economic Predictors on League Rank in the 2023-2024 Season"
author: 
  - Isabella MacLean
thanks: "Code and data are available at: https://github.com/Bellamaclean7/English_Premier_League_Economic
_Predictors_on_League_Rank_2023-2024_Season.git."
date: today
date-format: long
abstract: "This project will investigate how to formulate a linear regression model based on three explanatory variables: match attendance, total payroll, and market value, in order to try and predict a teams finishing place in the standings. Utilizing R's lm function, this paper analyzes the relationship between these variables and teams total points accumulated during the 2023-2024 season. Findings suggest that each explanatory variable significantly influences a team's league position (total points), highlighting the association between team success and team wealth."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(dplyr)
library(corrplot)
library(dplyr)
library(knitr)
library(readr)
library(here)
library(kableExtra)

analysis_data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))
show_col_types = FALSE

matchday_attendance <- read_csv(here::here("data/raw_data/average_home_matchday_attendance_2023-2024.csv"))
show_col_types = FALSE

market_value <- read_csv(here::here("data/raw_data/market_value_2023-2024.csv"))
show_col_types = FALSE

team_rank <- read_csv(here::here("data/raw_data/team_rank_2023-2024.csv"))
show_col_types = FALSE

total_payroll <- read_csv(here::here("data/raw_data/total_payroll_2023-2024.csv"))
show_col_types = FALSE

total_transfer_spending <- read_csv(here::here("data/raw_data/total_transfer_spending_2023-2024.csv"))
show_col_types = FALSE
```


# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

# Model

## Linear Regression

A linear regression model is a statistical model for linear relationships between variables given by

$$
Y_i = \beta_0 + \beta_1 X_{i,1} + \beta_2 X_{i,2} + \ldots + \beta_p X_{i,p} + \varepsilon_i \quad \text{for } i = 1, \ldots, n. \tag{1}
$$

As shown in equation (1) a linear regression model has the following components:

- $Y_i$: The dependent variable for the $i^{th}$ observation. This is the response variable that is trying to be predicted or explained, dependent on the corresponding explanatory variables $X_{i,1}, X_{i,2}, \ldots, X_{i,p}$.

- $\beta_0$: The intercept of the regression line. It represents the expected value of $Y_i$ when all the independent variables ($X$) are equal to 0.

- $\beta_1, \beta_2, \ldots, \beta_p$: The coefficients of the model. Each $\beta_j$ (for $j = 1, \ldots, p$) represents the expected change in $Y_i$ for a one-unit change in the $j^{th}$ independent variable, $X_{i,j}$, holding all other variables constant.

- $X_{i,1}, X_{i,2}, \ldots, X_{i,p}$: The independent variables (also called predictors or explanatory variables) for the $i^{th}$ observation. These variables are used to predict the value of the dependent variable.

- $\varepsilon_i$: The error term for the $i^{th}$ observation. It represents the difference between the observed value of the dependent variable and the value predicted by the model. It's assumed to be randomly distributed with a mean of 0.

- $i = 1, \ldots, n$: This indicates that the equation applies to each observation in the dataset, from the first ($i = 1$) to the $n^{th}$ (the last observation), where $n$ is the total number of observations.

## Model set-up
$$
\begin{split}
\text{pts}_i =\ &\beta_0 + \beta_1 \times \text{average\_home\_matchday\_attendance}_i \\
&+ \beta_2 \times \text{total\_wage\_bill}_i + \beta_3 \times \text{market\_value}_i + \varepsilon_i
\end{split}
\tag{2}
$$

Equation (2) can be explained as follows: 

- $\text{pts}_i$: The dependent variable for the $i^{th}$ observation. This is the outcome variable that the model is trying to predict or explain, which in this context could represent points (or any other metric of success) associated with each observation.

- $\beta_1, \beta_2, \beta_3$: The coefficients of the model. Each of these coefficients represents the expected change in $\text{pts}_i$ for a one-unit increase in their respective independent variable, assuming all other variables are held constant.
    - $\beta_1$ is associated with $\text{average\_home\_matchday\_attendance}_i$, indicating how changes in home matchday attendance are expected to affect $\text{pts}_i$.
    - $\beta_2$ corresponds to $\text{total\_wage\_bill}_i$, reflecting the impact of the total wage bill on $\text{pts}_i$.
    - $\beta_3$ is linked with $\text{market\_value}_i$, showing how the market value is predicted to influence $\text{pts}_i$.

## Model justification

The linear regression model given by Equation (2), derived from the foundational principles of linear regression outlined in Equation (1), provides a transparent mechanism to quantify the impact of various factors on the total points accumulated by EPL teams (a direct correlation to team rank in league standings). The model will aid in gaining insights into how attendance, total payroll, and market value could affect performance metrics. The model is operationalized using the `lm` function in `R`.

# Results

```{r}
#| warning: false
#| echo: false
#| label: fig-pts_vs_average_home_matchday_attendance
#| fig-cap: Figure 1 presents a scatter plot illustrating the relationship between total league points and average matchday attendance during the 2023-2024 season. Each point represents a team, plotted with their total points on the x-axis and their average home attendance on the y-axis. The trend line, added using linear regression analysis, suggests a correlation between team performance and matchday turnout. The correlation coefficient of 0.694060419947882 indicates a positive association with moderate correlation, where teams with higher league points tend to have greater average attendance.

# Calculate correlation coefficient for league position and average attendance
cor_attendance <- cor(analysis_data$pts, analysis_data$average_home_matchday_attendance, use = "complete.obs")

# Create a scatter plot for league position and average attendance
ggplot(analysis_data, aes(x = pts, y = average_home_matchday_attendance)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = "Figure 1: Average Matchday Attendance in Relation 
       to League Position for the 2023-2024 Season",
       subtitle = paste("Correlation coefficient:", cor_attendance),
       x = "Total League Points",
       y = "Average Attendance")
```

```{r}
#| warning: false
#| echo: false
#| label: fig-pts_vs_total_wage_bill
#| fig-cap: Figure 2 depicts the association between total league points and the total payroll for teams in the 2023-2024 season. Each point on the plot corresponds to a team, positioned according to their accumulated points for the season along the x-axis and their respective payroll on the y-axis. The linear regression trend line suggests a correlation between a teamâ€™s financial expenditure on payroll and their success in the league. A correlation coefficient of 0.770829037567151 reflects a positive relationship, implying that teams with higher payrolls may be more likely to accumulate greater league points.

# Calculate correlation coefficient for league position and average total wages
cor_wages <- cor(analysis_data$pts, analysis_data$total_wage_bill, use = "complete.obs")

# Create a scatter plot for league position and average total wages
ggplot(analysis_data, aes(x = pts, y = total_wage_bill)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = "Figure 2: Total Payroll in Relation to League 
       Points for the 2023-2024 Season",
       subtitle = paste("Correlation coefficient:", cor_wages),
       x = "Total League Points",
       y = "Total Payroll")
```

```{r}
#| warning: false
#| echo: false
#| label: fig-pts_vs_transfer_fees
#| fig-cap: Figure 3 illustrates the relationship between teams total transfer spending and their corresponding league points for the 2023-2024 season. The scatter plot shows each team as a distinct point, positioned by their total league points on the x-axis and their transfer spending on the y-axis. The trend line, calculated with linear regression, indicates a moderate positive correlation, with a correlation coefficient of approximately 0.417985956450557. This suggests that higher league points tend to coincide with increased transfer spending, although the relationship is not strongly linear.

# Calculate correlation coefficient for league position and total transfer fees
cor_transfers <- cor(analysis_data$pts, analysis_data$transfer_fees, use = "complete.obs")

# Create a scatter plot for league position and average total wages
ggplot(analysis_data, aes(x = pts, y = transfer_fees)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = "Figure 3: Average Transfer Spending in Relation to 
       League Points for the 2023-2024 Season",
       subtitle = paste("Correlation coefficient:", cor_transfers),
       x = "Total League Points",
       y = "Total Transfer Fees")
```
```{r}
#| warning: false
#| echo: false
#| label: fig-pts_vs_market_value
#| fig-cap: Figure 4 demonstrates the correlation between the current market value of teams and their accumulated league points for the 2023-2024 season. The scatter plot places each team by the total points they have secured on the x-axis against their market value on the y-axis. A pronounced upward trend represented by the linear regression line, with a correlation coefficient of 0.849962012423038, indicates a strong positive relationship. This suggests that teams with higher market values tend to amass more league points, underlining a potential link between financial strength and on-field success.

# Calculate correlation coefficient for league position and market value
cor_market <- cor(analysis_data$pts, analysis_data$market_value, use = "complete.obs")

# Create a scatter plot for league position and market value
ggplot(analysis_data, aes(x = pts, y = market_value)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = "Figure 4: Current Market Value in Relation 
       to League Points for the 2023-2024 Season",
       subtitle = paste("Correlation coefficient:", cor_market),
       x = "Total League Points",
       y = "Total Market Value")
```


# Discussion

## First discussion point {#sec-first-point}

## Second discussion point

## Third discussion point

## Weaknesses and next steps

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

## Diagnostics

\newpage


# References


